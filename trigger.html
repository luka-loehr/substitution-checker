<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vertretungsplan Checker</title>
    <!-- Add Tailwind for base styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Add loading animation library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        :root {
            --primary: #2563eb;
            --success: #16a34a;
            --error: #dc2626;
            --warning: #ca8a04;
        }

        body { 
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            min-height: 100vh;
            color: #fff;
        }

        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        .container {
            max-width: 600px;
            margin: 20px auto;
            padding: 24px;
            border-radius: 16px;
            animation: fadeIn 1s ease-out;
        }

        .btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            transform: translateY(0);
        }

        .btn:active {
            transform: translateY(2px);
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn:hover::after {
            width: 200%;
            height: 200%;
        }

        .log-window {
            height: 0;
            opacity: 0;
            transition: all 0.5s ease;
            overflow: hidden;
        }

        .log-window.active {
            height: 200px;
            opacity: 1;
        }

        .log-entry {
            animation: slideInRight 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .log-entry::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .log-entry.success::before { background: var(--success); }
        .log-entry.pending::before { background: var(--warning); }
        .log-entry.error::before { background: var(--error); }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .result-window {
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.5s ease;
        }

        .result-window.active {
            transform: translateY(0);
            opacity: 1;
        }

        /* Loading spinner */
        .loader {
            width: 20px;
            height: 20px;
            border: 2px solid #fff;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .settings-panel {
            max-height: 0;
            opacity: 0;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .settings-panel.active {
            max-height: 200px;
            opacity: 1;
        }
    </style>
</head>
<body class="p-4">
    <div class="container glass">
        <h1 class="text-3xl font-bold text-center mb-8 animate__animated animate__fadeInDown">
            Vertretungsplan
            <span class="block text-lg text-blue-300 mt-1">Checker</span>
        </h1>
        
        <div id="settings-panel" class="settings-panel mb-6">
            <input type="password" 
                   id="token-input" 
                   class="w-full p-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/50 mb-3"
                   placeholder="GitHub Personal Access Token" />
            <button onclick="saveToken()" 
                    class="w-full btn bg-white/20 hover:bg-white/30 text-white py-2 rounded-lg transition-all">
                Save Token
            </button>
        </div>
        
        <div class="grid grid-cols-2 gap-4 mb-6 animate__animated animate__fadeInUp">
            <button onclick="triggerWorkflow('email')" 
                    class="btn bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-6 rounded-lg font-medium">
                Send via Email
            </button>
            <button onclick="triggerWorkflow('check')" 
                    class="btn bg-gradient-to-r from-green-600 to-green-700 text-white py-3 px-6 rounded-lg font-medium">
                Check Now
            </button>
        </div>

        <div id="log-window" class="log-window glass rounded-lg p-4 mb-6">
            <!-- Log entries will be added here -->
        </div>

        <div id="result-window" class="result-window glass rounded-lg p-6 mb-6" style="display: none;">
            <h2 id="result-title" class="text-xl font-semibold mb-4"></h2>
            <div id="result-content" class="text-gray-200"></div>
        </div>
        
        <button onclick="toggleSettings()" 
                class="btn w-full bg-white/10 hover:bg-white/20 text-white py-2 rounded-lg transition-all">
            Settings
        </button>
    </div>

    <script>
    const GITHUB_USERNAME = "luka-loehr";
    const REPO_NAME = "substitution-checker";
    const BRANCH_NAME = "main";
    
    function toggleSettings() {
        const settingsPanel = document.getElementById('settings-panel');
        settingsPanel.classList.toggle('active');
        
        if (settingsPanel.classList.contains('active')) {
            const storedToken = localStorage.getItem('github_token');
            if (storedToken) {
                document.getElementById('token-input').value = storedToken;
            }
        }
    }
    
    function saveToken() {
        const token = document.getElementById('token-input').value.trim();
        if (token) {
            localStorage.setItem('github_token', token);
            document.getElementById('settings-panel').classList.remove('active');
            addLogEntry('Token saved successfully', 'success');
        } else {
            addLogEntry('Token cannot be empty', 'error');
        }
    }

    function addLogEntry(message, type = 'pending') {
        const logWindow = document.getElementById('log-window');
        logWindow.classList.add('active');
        
        const entry = document.createElement('div');
        entry.className = `log-entry ${type} mb-2 text-sm animate__animated animate__fadeInRight`;
        
        if (type === 'pending') {
            entry.innerHTML = `
                <span class="loader mr-2"></span>
                ${message}
            `;
        } else {
            entry.textContent = message;
        }
        
        logWindow.appendChild(entry);
        logWindow.scrollTop = logWindow.scrollHeight;
    }

    function showResult(title, content) {
        const resultWindow = document.getElementById('result-window');
        document.getElementById('result-title').textContent = title;
        document.getElementById('result-content').textContent = content;
        
        document.getElementById('log-window').classList.remove('active');
        resultWindow.style.display = 'block';
        setTimeout(() => resultWindow.classList.add('active'), 100);
    }

    [Rest of the JavaScript remains the same as in the previous version]
    </script>
</body>
</html>
